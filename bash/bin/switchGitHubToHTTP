#!/usr/bin/env bash
# ------------------------------------------------------------------------------
# ğŸ§° fix-git-url.sh â€” Recursively convert SSH GitHub URLs to HTTP
#   From: url = git@github.com:Traap/
#   To:   url = http://github.com/Traap/
# ------------------------------------------------------------------------------

set -euo pipefail

echo "ğŸ” Scanning for .git/config files..."
count=0

# Use find for deep recursion â€” handles nested repo structures
while IFS= read -r config; do
  repo_dir="$(dirname "$(dirname "$config")")"
  if grep -q "url = git@github.com:Traap/" "$config"; then
    echo "âš™ï¸  Updating repo: $repo_dir"
    sed -i 's|url = git@github.com:Traap/|url = http://github.com/Traap/|' "$config"
    ((count++))
  fi
done < <(find . -type f -path "*/.git/config")

echo "âœ… Updated $count repositories total."

