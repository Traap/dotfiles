#!/bin/bash
#
# Inspired by:
#  Doug Bell - "Organized Development with tmux", Jun 18, 2019
#               Conference in the Cloud A Perl and Raku Conf
#
# https://www.youtube.com/watch?v=o7Dg1kmjhfQ&t=2428s
#
# Name: Alpha and Omega
#   ao
#
# Use:
#  ao kjv
#
# Argument:
#  $1 tmux session name
#
# Note:
#   1. A session is created or attached to.
#   2. A new session is added if ao is used from with a tmux session.
# ------------------------------------------------------------------------------

if [[ $# -eq 1 ]]; then
  if ! tmux has-session    -t $1 2>/dev/null; then case $1 in
      "ao")
        tmux new-session   -c ${HOME}/git/dotfiles/bin -n ao -s $1 -d
        tmux send-keys     -t $1:1 '$EDITOR ao' Enter
        ;;
      "bash")
        tmux new-session   -c ${HOME}/git/dotfiles  -n dotfiles   -s $1 -d
        tmux new-window    -c ${HOME}/git/dotfiles  -n bashrc     -t $1:2

        tmux send-keys     -t $1:2 \
          '$EDITOR \
            bashrc \
            bashrc-personal \
            bash_logout \
            my_aliases \
            my_completions \
            my_exports \
            my_functions \
            my_paths \
            my_prompt \
          ' Enter

        tmux select-window -t $1:1
        ;;
      "havasu")
        tmux new-session   -c ${HOME}/git/havasu    -n havasu     -s $1 -d
        ;;
      "kjv")
        tmux new-session   -c ${HOME}/git/kjv       -n kjv        -s $1 -d
        ;;
      "ssh")
        tmux new-session   -c ${HOME}/git/ssh       -n ssh        -s $1 -d
        tmux new-window    -c ${HOME}/git/tmux      -n tmux       -t $1:2

        tmux send-keys     -t $1:1 '$EDITOR -O config gitconfig' Enter
        tmux send-keys     -t $1:2 '$EDITOR tmux.conf' Enter
        ;;
      "soup")
        tmux new-session   -c ${HOME}/git/amber     -n amber      -s $1 -d
        tmux new-window    -c ${HOME}/git/autodoc   -n autodoc    -t $1:2
        tmux new-window    -c ${HOME}/git/newdoc    -n newdoc     -t $1:3
        ;;
      "vim")
        tmux new-session   -c ${HOME}/git/vim      -n vim        -s $1 -d

        tmux send-keys     -t $1:1 \
          '$EDITOR \
            vimrc \
            bootstrap.vim \
            plug.vim \
            bundle/vim-bundle-keybindings/plugin/bundle-keybindings.vim \
            bundle/vim-bundle-settings/plugin/bundle-settings.vim \
            bundle/vim-bundle-terminal/plugin/bundle-terminal.vim \
          ' Enter 

        tmux select-window -t $1:1
        ;;
      "work")
        tmux new-session   -c ${HOME}/git/wiki      -n wiki       -s $1 -d
        tmux new-window    -c ${HOME}/git           -n 'GH Repos' -t $1:2
        tmux new-window    -c ${HOME}/bb            -n 'BB Repos' -t $1:3

        tmux send-keys     -t $1:1 '$EDITOR index.wiki'   Enter
        tmux select-window -t $1:1
        ;;
      *)
        echo "Session name $1 is not supported."
        exit
        ;;
    esac
  fi
else
  echo "Session name [ao|bash|kjv|ssh|soup|work] is required" && exit
fi

# Attach to tmux session. 
[[ ! -n $TMUX ]] && tmux attach -t $1
exit 0
