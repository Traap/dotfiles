#!/bin/bash
#
# Inspired by:
#  Doug Bell - "Organized Development with tmux", Jun 18, 2019
#               Conference in the Cloud A Perl and Raku Conf
#
# https://www.youtube.com/watch?v=o7Dg1kmjhfQ&t=2428s
#
# Name: Alpha and Omega
#   ao
#
# Use:
#  ao kjv
#
# Argument:
#  $1 tmux session name
#
# Note:
#   1. A session is created or attached to.
#   2. A new session is added if ao is used from with a tmux session.
# ------------------------------------------------------------------------------

if [[ $# -eq 1 ]]; then
  if ! tmux has-session -t $1 2>/dev/null; then case $1 in
      "ao")
        tmux new-session -c ${HOME}/git/dotfiles/bin -n ao -s $1 -d
        tmux send-keys   -t $1:1 '$EDITOR ao' Enter
        ;;
      "bash")
        tmux new-session -c ${HOME}/git/dotfiles     -n dotfiles        -s $1 -d
        tmux new-window  -c ${HOME}/git/dotfiles     -n bashrc          -t $1:2

        tmux send-keys   -t $1:2  '$EDITOR \
          bashrc \
          bashrc-personal \
          bash_logout \
          my_aliases \
          my_completions \
          my_exports \
          my_functions \
          my_paths \
          my_prompt'       Enter

        tmux select-window -t $1:1
        ;;
      "havasu")
        tmux new-session -c ${HOME}/git/havasu       -n havasu     -s $1 -d
        ;;
      "kjv")
        tmux new-session -c ${HOME}/git/kjv          -n kjv        -s $1 -d
        ;;
      "ssh")
        tmux new-session -c ${HOME}/git/ssh          -n ssh        -s $1 -d
        tmux new-window  -c ${HOME}/git/tmux         -n tmux       -t $1:2

        tmux send-keys   -t $1:1 '$EDITOR -O config gitconfig' Enter
        tmux send-keys   -t $1:2 '$EDITOR tmux.conf' Enter
        ;;
      "soup")
        tmux new-session -c ${HOME}/git/amber        -n amber      -s $1 -d
        tmux new-window  -c ${HOME}/git/autodoc      -n autodoc    -t $1:2
        tmux new-window  -c ${HOME}/git/newdoc       -n newdoc     -t $1:3
        ;;
      "$EDITOR")
        tmux new-session -c ${HOME}/git/$EDITOR      -n $EDITORrc  -s $1 -d
        tmux new-window  -c ${HOME}/git/$EDITOR      -n bootstrap  -t $1:2
        tmux new-window  -c ${HOME}/git/$EDITOR      -n plug       -t $1:3
        tmux new-window  -c ${HOME}/git/$EDITOR      -n init       -t $1:4

        tmux send-keys   -t $1:1 '$EDITOR vimrc'         Enter
        tmux send-keys   -t $1:2 '$EDITOR bootstrap.vim' Enter
        tmux send-keys   -t $1:3 '$EDITOR plug.vim'      Enter
        tmux send-keys   -t $1:4 '$EDITOR initvim'       Enter

        tmux select-window -t $1:3
        ;;
      "work")
        tmux new-session -c ${HOME}/git/wiki         -n wiki       -s $1 -d

        tmux send-keys   -t $1:1 '$EDITOR index.wiki'   Enter
        ;;
      *)
        echo "Session name $1 is not supported."
        exit
        ;;
    esac
  fi
else
  echo "Session name [ao|bash|kjv|ssh|soup|work] is required" && exit
fi

# Attach to tmux session. 
[[ ! -n $TMUX ]] && tmux attach -t $1
exit 0
